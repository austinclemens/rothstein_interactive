<!-- labor_part_history.html -->

<html>

<head>
	<title>School Finance Events 1990 to 2011</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.4.1/snap.svg-min.js"></script>
	<style>
		@import url(https://fonts.googleapis.com/css?family=Lato:400,700,900);

		body {margin-top:50px;font-family: 'Lato'; font-weight:300; line-height:140%; padding-bottom: 100px;font-size:17px;}
		input[type=text] {text-align:center;margin:0px;margin-right:5px;height:30px;padding:5px;max-width:40px;border-radius:3px;border:1px solid black;font-size:15px;color:#aaa;font-weight:400;}
		select{text-align:center;margin:0px;margin-right:5px;height:30px;padding:5px;max-width:60px;border-radius:3px;border:1px solid black;font-size:15px;color:#666;font-weight:400;}

		.slopegraph{max-width:745px}
		.hed{font-family:'Lato';font-size:22px;font-weight:700;}
		.dek{font-family:'Lato';font-size:17px;margin-bottom:20px;}
		.note{font-family:'Lato';font-size:11px;margin-top:20px;line-height:1.1;}
		.controls{text-align:center;margin-bottom:30px;}
		.sgbuttonleft{text-align:center;margin:0px;padding:5px;height:30px;border-radius:3px;border:1px solid black;font-size:15px;color:white;font-weight:300;background:#33836A;border-top-right-radius:0px;border-bottom-right-radius:0px;margin-right:0px;padding-left:7px;padding-right:7px}
		.sgbuttonright{text-align:center;margin:0px;padding:5px;height:30px;border-radius:3px;border:1px solid black;font-size:15px;color:white;font-weight:300;background:#33836A;border-top-left-radius:0px;border-bottom-left-radius:0px;margin-left:0px;border-left:0px;padding-left:7px;padding-right:7px}
		.sgbuttonleft:hover{background:#67c2a5}
		.sgbuttonright:hover{background:#67c2a5}
		.pressed{background:#67c2a5;-moz-box-shadow:inset 0 0 2px #666;-webkit-box-shadow:inset 0 0 2px #666;box-shadow:inset 0 0 2px #666;}
	</style>

</head>

<body>

	<div class='slopegraph'>
<!-- 		<div class='hed'>Public school funding has become more progressive in most states</div>
		<div class='dek'>Mouse over the lines to see how progressive school funding was in each statebetween 1990 and 2011. Circles indicate years where reform was enacted by the court or by legislative statute.</div>
 -->		<div class='controls'>
			Choose a state: <select onchange='statechange()' id='state_select'>
				<option value="AL">AL</option>
				<option value="AK">AK</option>
				<option value="AZ">AZ</option>
				<option value="AR">AR</option>
				<option value="CA">CA</option>
				<option value="CO">CO</option>
				<option value="CT">CT</option>
				<option value="DE">DE</option>
				<option value="FL">FL</option>
				<option value="GA">GA</option>
				<option value="ID">ID</option>
				<option value="IL">IL</option>
				<option value="IN">IN</option>
				<option value="IA">IA</option>
				<option value="KS">KS</option>
				<option value="KY">KY</option>
				<option value="LA">LA</option>
				<option value="ME">ME</option>
				<option value="MD">MD</option>
				<option value="MA">MA</option>
				<option value="MI">MI</option>
				<option value="MN">MN</option>
				<option value="MS">MS</option>
				<option value="MO">MO</option>
				<option value="MT">MT</option>
				<option value="NE">NE</option>
				<option value="NV">NV</option>
				<option value="NH">NH</option>
				<option value="NJ" selected>NJ</option>
				<option value="NM">NM</option>
				<option value="NY">NY</option>
				<option value="NC">NC</option>
				<option value="ND">ND</option>
				<option value="OH">OH</option>
				<option value="OK">OK</option>
				<option value="OR">OR</option>
				<option value="PA">PA</option>
				<option value="RI">RI</option>
				<option value="SC">SC</option>
				<option value="SD">SD</option>
				<option value="TN">TN</option>
				<option value="TX">TX</option>
				<option value="UT">UT</option>
				<option value="VT">VT</option>
				<option value="VA">VA</option>
				<option value="WA">WA</option>
				<option value="WV">WV</option>
				<option value="WI">WI</option>
				<option value="WY">WY</option>
			</select>
			<button type="button" id='statebutton' class='sgbuttonleft pressed' onclick='buttondown(1)'>State Funding</button><button type="button" id='totalbutton' class='sgbuttonright' onclick='buttondown(0)'>Total Revenues</button>
		</div>
		<svg id="slopegraph" viewbox='0,-3,745,703' ></svg>
		<div class='note'>Note: Low income districts are those with average household-income in the bottom 20% of all in the same state districts. High-income districts are those with average household-income in the top 20% of all districts in the same state. Hawaii was excluded as there is only one school district in Hawaii.</div>
	</div>

</body>

<script defer>
var sg = Snap('#slopegraph')
var sgwidth=745
var sgheight=703
var size=13
var maxwidth=70
var data={'WA': [[1.12, 1.08, 0.0], [0.0, 0.0, 0.0], [1.05, 1.0, 0.0], [1.08, 1.0, 0.0], [1.14, 1.03, 0.0], [1.2, 1.09, 0.0], [1.19, 1.1, 0.0], [1.17, 1.05, 0.0], [1.2, 1.07, 0.0], [1.16, 1.04, 0.0], [1.14, 1.02, 0.0], [1.2, 1.03, 0.0], [1.19, 1.03, 0.0], [1.12, 1.02, 0.0], [1.16, 1.03, 0.0], [1.13, 1.0, 0.0], [1.2, 1.06, 0.0], [1.2, 1.05, 0.0], [1.19, 1.05, 0.0], [1.23, 1.06, 0.0], [1.04, 0.97, 1.0], [1.18, 1.02, 0.0]], 'DE': [[1.1, 0.84, 0.0], [0.0, 0.0, 0.0], [1.26, 1.0, 0.0], [1.3, 1.03, 0.0], [1.21, 0.97, 0.0], [1.15, 0.88, 0.0], [0.82, 0.74, 0.0], [1.09, 0.87, 0.0], [1.2, 0.93, 0.0], [1.48, 1.1, 0.0], [1.41, 1.06, 0.0], [1.3, 1.04, 0.0], [1.26, 1.03, 0.0], [1.12, 0.93, 0.0], [0.85, 0.78, 0.0], [1.12, 0.92, 0.0], [1.09, 0.88, 0.0], [1.05, 0.88, 0.0], [1.14, 0.9, 0.0], [1.33, 0.97, 0.0], [1.27, 0.91, 0.0], [1.2, 0.89, 0.0]], 'WI': [[1.38, 0.95, 0.0], [0.0, 0.0, 0.0], [1.37, 0.97, 0.0], [1.6, 0.98, 0.0], [1.72, 1.0, 0.0], [1.71, 0.98, 0.0], [1.71, 0.98, 0.0], [1.51, 0.99, 0.0], [1.5, 1.01, 0.0], [1.52, 1.03, 0.0], [1.48, 1.04, 0.0], [1.44, 1.03, 0.0], [1.41, 1.05, 0.0], [1.37, 1.08, 0.0], [1.4, 1.08, 0.0], [1.42, 1.09, 0.0], [1.35, 1.08, 0.0], [1.37, 1.08, 0.0], [1.39, 1.07, 0.0], [1.42, 1.07, 0.0], [1.44, 1.11, 0.0], [1.43, 1.12, 0.0]], 'WV': [[1.21, 0.99, 0.0], [0.0, 0.0, 0.0], [1.29, 1.08, 0.0], [1.23, 1.03, 0.0], [1.31, 1.06, 0.0], [1.35, 1.07, 1.0], [1.24, 0.98, 0.0], [1.23, 0.99, 0.0], [1.34, 1.06, 0.0], [1.3, 1.04, 0.0], [1.24, 1.02, 1.0], [1.17, 0.99, 0.0], [1.2, 1.01, 0.0], [1.2, 1.01, 0.0], [1.16, 0.98, 0.0], [1.19, 1.03, 0.0], [1.19, 1.04, 0.0], [1.21, 1.04, 0.0], [1.21, 1.05, 0.0], [1.11, 1.02, 0.0], [1.22, 1.06, 0.0], [1.27, 1.09, 0.0]], 'FL': [[1.51, 0.94, 0.0], [0.0, 0.0, 0.0], [1.76, 0.92, 0.0], [1.67, 0.9, 0.0], [1.6, 0.88, 0.0], [1.68, 0.9, 0.0], [1.64, 0.89, 0.0], [1.64, 0.89, 0.0], [1.64, 0.92, 0.0], [1.54, 0.93, 0.0], [1.54, 0.92, 0.0], [1.54, 0.91, 0.0], [1.65, 0.91, 0.0], [1.82, 0.93, 0.0], [1.66, 0.93, 0.0], [1.69, 0.92, 0.0], [1.74, 0.91, 0.0], [1.55, 0.88, 0.0], [1.52, 0.88, 0.0], [1.79, 0.93, 0.0], [1.89, 0.93, 0.0], [1.77, 0.94, 0.0]], 'WY': [[2.31, 1.1, 0.0], [0.0, 0.0, 0.0], [2.42, 1.17, 0.0], [2.46, 1.14, 0.0], [2.65, 1.14, 0.0], [3.51, 1.13, 1.0], [3.23, 1.07, 0.0], [3.28, 1.06, 2.0], [3.26, 1.07, 0.0], [2.54, 1.09, 0.0], [2.69, 1.09, 0.0], [3.18, 1.17, 2.0], [3.78, 1.15, 0.0], [4.3, 1.21, 0.0], [2.78, 1.23, 0.0], [4.01, 1.29, 0.0], [3.89, 1.13, 0.0], [2.94, 1.17, 0.0], [2.24, 1.14, 0.0], [2.23, 1.2, 0.0], [3.54, 1.35, 0.0], [3.68, 1.44, 0.0]], 'NH': [[2.9, 0.83, 0.0], [0.0, 0.0, 0.0], [2.43, 0.82, 0.0], [3.72, 0.83, 1.0], [3.53, 0.86, 0.0], [4.12, 0.86, 0.0], [3.92, 0.88, 0.0], [3.57, 0.83, 1.0], [3.0, 0.88, 0.0], [3.76, 0.9, 2.0], [1.06, 0.9, 0.0], [1.08, 0.91, 0.0], [1.07, 0.91, 1.0], [1.08, 0.91, 0.0], [1.06, 0.93, 0.0], [1.12, 0.9, 0.0], [1.39, 0.92, 0.0], [1.46, 0.94, 0.0], [1.5, 1.05, 2.0], [1.58, 1.08, 0.0], [1.68, 1.1, 0.0], [1.83, 1.09, 0.0]], 'NJ': [[3.05, 0.81, 3.0], [0.0, 0.0, 0.0], [2.2, 0.85, 0.0], [2.83, 0.87, 0.0], [3.33, 0.92, 1.0], [3.94, 0.91, 0.0], [3.97, 0.91, 2.0], [3.87, 0.93, 2.0], [4.66, 1.03, 1.0], [4.24, 1.06, 0.0], [4.88, 1.09, 1.0], [5.11, 1.06, 0.0], [4.76, 1.09, 0.0], [4.64, 1.07, 0.0], [4.36, 1.12, 0.0], [4.47, 1.1, 0.0], [4.79, 1.11, 0.0], [4.44, 1.13, 0.0], [4.79, 1.14, 2.0], [5.76, 1.22, 0.0], [4.56, 1.17, 0.0], [6.61, 1.08, 0.0]], 'NM': [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [1.33, 1.41, 0.0], [0.98, 1.28, 0.0], [1.05, 1.22, 0.0], [1.16, 1.22, 0.0], [1.17, 1.25, 0.0], [1.12, 1.21, 0.0], [1.25, 1.29, 0.0], [1.23, 1.31, 1.0], [1.26, 1.26, 0.0], [1.3, 1.29, 2.0], [1.37, 1.32, 0.0], [1.41, 1.39, 0.0], [1.45, 1.45, 0.0], [1.4, 1.4, 0.0], [1.33, 1.33, 0.0], [1.28, 1.24, 0.0], [1.29, 1.24, 0.0], [1.29, 1.28, 0.0], [1.28, 1.25, 0.0], [1.3, 1.26, 0.0]], 'TX': [[1.75, 0.98, 2.0], [0.0, 0.0, 1.0], [1.81, 1.11, 1.0], [1.75, 1.16, 2.0], [1.56, 1.03, 0.0], [1.58, 1.04, 0.0], [1.66, 1.07, 0.0], [1.81, 1.1, 0.0], [1.78, 1.1, 0.0], [1.79, 1.07, 0.0], [1.78, 1.07, 0.0], [1.8, 1.07, 0.0], [1.92, 1.07, 0.0], [1.99, 1.07, 0.0], [2.1, 1.09, 0.0], [2.26, 1.08, 0.0], [2.24, 1.08, 0.0], [1.96, 1.07, 0.0], [1.7, 1.09, 0.0], [1.74, 1.07, 0.0], [1.73, 1.09, 0.0], [1.71, 1.1, 0.0]], 'LA': [[1.11, 0.78, 0.0], [0.0, 0.0, 0.0], [1.08, 0.83, 0.0], [1.14, 0.83, 0.0], [1.16, 0.81, 0.0], [1.16, 0.78, 0.0], [1.21, 0.8, 0.0], [1.24, 0.79, 0.0], [1.28, 0.83, 0.0], [1.31, 0.84, 0.0], [1.36, 0.84, 0.0], [1.37, 0.84, 0.0], [1.36, 0.84, 0.0], [1.4, 0.87, 0.0], [1.44, 0.87, 0.0], [1.37, 0.82, 0.0], [1.37, 0.76, 0.0], [1.39, 0.8, 0.0], [1.44, 0.8, 0.0], [1.46, 0.82, 0.0], [1.48, 0.92, 0.0], [1.5, 0.94, 0.0]], 'NC': [[1.12, 0.98, 0.0], [0.0, 0.0, 0.0], [1.11, 0.97, 0.0], [1.12, 0.93, 0.0], [1.13, 0.97, 0.0], [1.17, 1.02, 0.0], [1.16, 0.95, 0.0], [1.19, 1.01, 1.0], [1.27, 1.06, 0.0], [1.24, 1.04, 0.0], [1.26, 1.04, 0.0], [1.29, 1.07, 0.0], [1.24, 1.05, 0.0], [1.21, 1.04, 0.0], [1.26, 0.98, 1.0], [1.28, 0.95, 0.0], [1.28, 0.95, 0.0], [1.33, 1.01, 0.0], [1.29, 1.01, 0.0], [1.28, 0.97, 0.0], [1.32, 0.96, 0.0], [1.32, 0.96, 0.0]], 'ND': [[1.13, 1.09, 0.0], [0.0, 0.0, 0.0], [1.08, 1.06, 0.0], [1.1, 1.0, 0.0], [1.06, 0.97, 0.0], [1.1, 0.99, 0.0], [1.13, 1.08, 0.0], [1.1, 1.03, 0.0], [1.08, 1.02, 0.0], [0.9, 0.94, 0.0], [1.11, 1.04, 0.0], [1.11, 1.04, 0.0], [1.11, 1.07, 0.0], [1.11, 1.06, 0.0], [1.07, 1.08, 0.0], [1.08, 1.11, 0.0], [1.12, 1.15, 0.0], [1.13, 1.19, 2.0], [1.11, 1.16, 0.0], [1.12, 1.22, 0.0], [1.07, 1.19, 0.0], [1.06, 1.17, 0.0]], 'NE': [[0.96, 1.02, 0.0], [0.0, 0.0, 0.0], [1.0, 1.01, 0.0], [0.93, 1.01, 0.0], [1.01, 1.05, 0.0], [1.13, 1.07, 0.0], [1.19, 1.06, 0.0], [1.26, 1.05, 0.0], [1.32, 1.05, 0.0], [1.27, 1.03, 0.0], [1.28, 1.01, 0.0], [1.36, 1.03, 0.0], [1.38, 1.03, 0.0], [1.32, 1.02, 0.0], [1.4, 1.09, 0.0], [1.39, 1.09, 0.0], [1.38, 1.11, 0.0], [1.32, 1.07, 0.0], [1.36, 1.07, 0.0], [1.42, 1.12, 0.0], [1.26, 1.1, 0.0], [1.06, 1.11, 0.0]], 'TN': [[1.06, 0.8, 0.0], [0.0, 0.0, 0.0], [1.07, 0.79, 2.0], [1.11, 0.84, 1.0], [1.16, 0.87, 0.0], [1.18, 0.86, 1.0], [1.23, 0.89, 0.0], [1.23, 0.87, 0.0], [1.23, 0.89, 0.0], [1.28, 0.9, 0.0], [1.29, 0.88, 0.0], [1.28, 0.85, 0.0], [1.3, 0.85, 1.0], [1.31, 0.87, 0.0], [1.35, 0.85, 0.0], [1.38, 0.86, 0.0], [1.41, 0.86, 0.0], [1.43, 0.86, 0.0], [1.4, 0.86, 0.0], [1.4, 0.88, 0.0], [1.41, 0.88, 0.0], [1.42, 0.89, 0.0]], 'NY': [[1.76, 0.66, 0.0], [0.0, 0.0, 0.0], [2.11, 0.68, 0.0], [2.18, 0.69, 0.0], [2.22, 0.7, 0.0], [2.25, 0.74, 0.0], [2.21, 0.74, 0.0], [2.23, 0.74, 0.0], [2.28, 0.75, 0.0], [2.15, 0.78, 0.0], [2.02, 0.8, 0.0], [1.96, 0.82, 0.0], [1.93, 0.84, 0.0], [1.89, 0.83, 1.0], [1.91, 0.81, 0.0], [1.92, 0.8, 0.0], [1.94, 0.8, 1.0], [1.93, 0.81, 2.0], [1.95, 0.83, 0.0], [1.99, 0.82, 0.0], [2.14, 0.84, 0.0], [2.08, 0.83, 0.0]], 'PA': [[1.62, 0.79, 0.0], [0.0, 0.0, 0.0], [1.91, 0.78, 0.0], [1.76, 0.78, 0.0], [1.88, 0.8, 0.0], [2.02, 0.83, 0.0], [2.03, 0.85, 0.0], [2.06, 0.85, 0.0], [2.14, 0.85, 0.0], [2.22, 0.86, 0.0], [2.31, 0.87, 0.0], [2.42, 0.87, 0.0], [2.51, 0.88, 0.0], [2.49, 0.88, 0.0], [2.55, 0.88, 0.0], [2.6, 0.88, 0.0], [2.64, 0.87, 0.0], [2.65, 0.86, 0.0], [2.66, 0.87, 0.0], [2.65, 0.89, 0.0], [2.6, 0.91, 0.0], [2.53, 0.91, 0.0]], 'CA': [[1.43, 0.99, 0.0], [0.0, 0.0, 0.0], [1.41, 0.98, 0.0], [1.5, 1.01, 0.0], [1.44, 0.97, 0.0], [1.55, 1.01, 0.0], [1.46, 0.99, 0.0], [1.46, 1.01, 0.0], [1.42, 1.0, 2.0], [1.44, 0.99, 0.0], [1.47, 0.99, 0.0], [1.34, 0.96, 0.0], [1.49, 0.98, 0.0], [1.5, 0.99, 0.0], [1.54, 0.97, 2.0], [1.44, 0.96, 0.0], [1.63, 1.03, 0.0], [1.5, 1.01, 0.0], [1.49, 0.98, 0.0], [1.58, 0.99, 0.0], [1.64, 0.94, 0.0], [1.69, 0.98, 0.0]], 'NV': [[1.56, 1.25, 0.0], [0.0, 0.0, 0.0], [2.26, 1.27, 0.0], [1.81, 1.16, 0.0], [1.84, 1.16, 0.0], [1.97, 1.15, 0.0], [1.75, 1.1, 0.0], [2.02, 1.17, 0.0], [1.91, 1.15, 0.0], [1.98, 1.19, 0.0], [2.08, 1.18, 0.0], [1.9, 1.14, 0.0], [1.88, 1.15, 0.0], [2.32, 1.24, 0.0], [2.1, 1.14, 0.0], [2.09, 1.17, 0.0], [1.9, 1.07, 0.0], [1.82, 1.13, 0.0], [1.65, 1.12, 0.0], [1.54, 1.14, 0.0], [1.7, 1.24, 0.0], [1.43, 1.4, 0.0]], 'VA': [[1.43, 0.7, 0.0], [0.0, 0.0, 0.0], [1.85, 0.71, 0.0], [1.91, 0.78, 0.0], [1.9, 0.78, 0.0], [1.96, 0.78, 0.0], [1.94, 0.75, 0.0], [1.87, 0.82, 0.0], [1.87, 0.77, 0.0], [1.84, 0.8, 0.0], [1.7, 0.83, 0.0], [1.69, 0.84, 0.0], [1.68, 0.81, 0.0], [1.66, 0.78, 0.0], [1.63, 0.78, 0.0], [1.69, 0.79, 0.0], [1.67, 0.75, 0.0], [1.63, 0.77, 0.0], [1.67, 0.77, 0.0], [1.72, 0.8, 0.0], [1.67, 0.83, 0.0], [1.61, 0.79, 0.0]], 'CO': [[1.35, 0.92, 0.0], [0.0, 0.0, 0.0], [1.49, 0.96, 0.0], [1.39, 0.77, 0.0], [1.29, 0.88, 0.0], [1.37, 0.97, 0.0], [1.44, 1.0, 0.0], [1.52, 1.02, 0.0], [1.55, 1.04, 0.0], [1.54, 1.01, 0.0], [1.52, 0.98, 2.0], [1.58, 0.99, 0.0], [1.49, 1.01, 0.0], [1.48, 1.03, 0.0], [1.46, 1.05, 0.0], [1.46, 1.06, 0.0], [1.44, 1.09, 0.0], [1.49, 1.07, 0.0], [1.61, 1.1, 0.0], [1.44, 1.09, 0.0], [0.74, 0.79, 0.0], [1.62, 1.09, 0.0]], 'AK': [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [1.38, 1.49, 0.0], [1.03, 1.01, 0.0], [1.91, 1.37, 0.0], [1.85, 1.35, 0.0], [1.78, 1.34, 0.0], [1.78, 1.57, 0.0], [1.72, 1.54, 0.0], [1.27, 1.06, 0.0], [1.41, 1.21, 0.0], [1.7, 1.69, 0.0], [1.82, 1.46, 0.0], [1.95, 1.55, 0.0], [2.22, 1.68, 0.0], [2.53, 1.86, 0.0], [1.91, 1.56, 0.0], [1.83, 1.55, 1.0], [2.03, 1.69, 0.0], [1.88, 1.49, 0.0], [2.0, 1.59, 0.0], [2.1, 1.53, 0.0]], 'AL': [[1.03, 0.81, 0.0], [0.0, 0.0, 0.0], [1.02, 0.82, 0.0], [1.02, 0.83, 0.0], [1.02, 0.82, 0.0], [1.06, 0.87, 0.0], [1.01, 0.81, 0.0], [1.09, 0.87, 0.0], [1.1, 0.82, 0.0], [1.11, 0.8, 0.0], [1.11, 0.83, 0.0], [1.12, 0.84, 0.0], [1.12, 0.83, 0.0], [1.17, 0.87, 0.0], [1.18, 0.86, 0.0], [1.17, 0.9, 0.0], [1.17, 0.92, 0.0], [1.16, 0.84, 0.0], [1.18, 0.93, 0.0], [1.17, 0.93, 0.0], [1.27, 0.98, 0.0], [1.17, 0.99, 0.0]], 'AR': [[1.24, 1.08, 0.0], [0.0, 0.0, 0.0], [1.21, 1.08, 0.0], [1.17, 1.08, 0.0], [1.17, 1.04, 1.0], [1.15, 1.06, 2.0], [1.24, 1.05, 0.0], [1.21, 1.05, 0.0], [1.16, 1.04, 0.0], [1.25, 1.05, 0.0], [1.26, 1.03, 0.0], [1.18, 1.04, 0.0], [1.18, 1.03, 1.0], [1.23, 1.05, 0.0], [1.23, 0.98, 0.0], [1.26, 1.03, 1.0], [1.23, 1.02, 0.0], [1.28, 1.05, 2.0], [1.28, 1.06, 0.0], [1.36, 1.08, 0.0], [1.32, 1.1, 0.0], [1.36, 1.11, 0.0]], 'VT': [[2.02, 0.95, 0.0], [0.0, 0.0, 0.0], [1.71, 0.9, 0.0], [2.17, 0.92, 0.0], [2.35, 0.98, 0.0], [2.25, 0.99, 0.0], [1.94, 0.93, 0.0], [1.79, 0.91, 1.0], [1.83, 0.98, 0.0], [1.16, 1.0, 0.0], [0.92, 0.91, 0.0], [1.02, 0.91, 0.0], [1.06, 0.92, 0.0], [1.11, 0.96, 2.0], [1.5, 1.18, 0.0], [1.02, 0.99, 0.0], [0.98, 0.97, 0.0], [1.01, 1.0, 0.0], [1.04, 1.02, 0.0], [1.0, 1.03, 0.0], [0.99, 1.0, 0.0], [1.02, 1.05, 0.0]], 'IL': [[2.25, 0.63, 0.0], [0.0, 0.0, 0.0], [2.61, 0.6, 0.0], [2.68, 0.63, 0.0], [2.66, 0.67, 0.0], [2.67, 0.7, 0.0], [2.7, 0.67, 0.0], [2.59, 0.69, 0.0], [2.52, 0.7, 0.0], [2.4, 0.73, 0.0], [1.98, 0.72, 0.0], [2.0, 0.75, 0.0], [2.06, 0.76, 0.0], [1.98, 0.75, 0.0], [2.04, 0.75, 0.0], [2.23, 0.75, 0.0], [2.48, 0.71, 0.0], [2.35, 0.71, 0.0], [2.15, 0.7, 0.0], [2.0, 0.72, 0.0], [1.65, 0.67, 0.0], [1.9, 0.73, 0.0]], 'GA': [[1.22, 0.88, 0.0], [0.0, 0.0, 0.0], [1.25, 0.89, 0.0], [1.27, 0.98, 0.0], [1.34, 0.91, 0.0], [1.38, 0.96, 0.0], [1.24, 0.91, 0.0], [1.18, 0.9, 0.0], [1.23, 0.9, 0.0], [1.24, 0.9, 0.0], [1.25, 0.91, 0.0], [1.24, 0.9, 0.0], [1.27, 0.94, 0.0], [1.24, 0.98, 0.0], [1.31, 0.92, 0.0], [1.29, 0.99, 0.0], [1.24, 0.97, 0.0], [1.3, 0.98, 0.0], [1.29, 0.99, 0.0], [1.37, 1.02, 0.0], [1.34, 1.03, 0.0], [1.24, 1.03, 0.0]], 'IN': [[1.05, 1.03, 0.0], [0.0, 0.0, 0.0], [1.08, 1.01, 0.0], [1.07, 0.97, 0.0], [1.13, 1.01, 0.0], [1.11, 1.0, 0.0], [1.11, 0.98, 0.0], [1.11, 0.98, 0.0], [1.13, 1.0, 0.0], [1.15, 1.0, 0.0], [1.15, 1.0, 0.0], [1.17, 1.02, 0.0], [1.15, 1.01, 0.0], [1.2, 1.08, 0.0], [1.2, 1.04, 0.0], [1.24, 1.04, 0.0], [1.29, 1.1, 0.0], [1.3, 1.06, 0.0], [1.31, 1.09, 0.0], [1.28, 1.07, 0.0], [1.19, 1.05, 0.0], [1.19, 1.09, 2.0]], 'IA': [[1.04, 1.03, 0.0], [0.0, 0.0, 0.0], [1.05, 1.03, 0.0], [0.99, 1.0, 0.0], [1.02, 1.02, 0.0], [1.02, 1.0, 0.0], [1.07, 1.02, 0.0], [1.06, 1.02, 0.0], [1.07, 1.03, 0.0], [1.08, 1.04, 0.0], [1.07, 1.03, 0.0], [1.08, 1.01, 0.0], [1.08, 1.02, 0.0], [1.07, 1.05, 0.0], [1.07, 1.05, 0.0], [1.12, 1.07, 0.0], [1.11, 1.08, 0.0], [1.1, 1.07, 0.0], [1.11, 1.03, 0.0], [1.07, 1.03, 0.0], [1.05, 1.01, 0.0], [1.05, 1.03, 0.0]], 'OK': [[1.29, 1.09, 0.0], [0.0, 0.0, 0.0], [1.34, 1.24, 0.0], [1.14, 1.1, 0.0], [1.2, 1.15, 0.0], [1.3, 1.12, 0.0], [1.27, 1.11, 0.0], [1.29, 1.11, 0.0], [1.32, 1.12, 0.0], [1.32, 1.13, 0.0], [1.33, 1.13, 0.0], [1.35, 1.14, 0.0], [1.32, 1.13, 0.0], [1.38, 1.15, 0.0], [1.41, 1.13, 0.0], [1.4, 1.13, 0.0], [1.4, 1.13, 0.0], [1.35, 1.07, 0.0], [1.37, 1.12, 0.0], [1.35, 1.1, 0.0], [1.37, 1.08, 0.0], [1.31, 1.1, 0.0]], 'AZ': [[1.46, 1.05, 0.0], [0.0, 0.0, 0.0], [1.36, 0.96, 0.0], [1.55, 1.01, 0.0], [1.46, 1.04, 1.0], [1.43, 1.06, 0.0], [1.41, 1.0, 0.0], [1.32, 1.0, 1.0], [1.21, 0.98, 1.0], [1.54, 1.1, 0.0], [1.26, 1.11, 0.0], [1.2, 1.03, 0.0], [1.5, 1.05, 0.0], [1.54, 1.01, 0.0], [1.54, 0.99, 0.0], [1.58, 1.05, 0.0], [1.49, 1.11, 0.0], [1.43, 1.11, 0.0], [1.42, 1.09, 0.0], [1.46, 1.14, 0.0], [1.75, 1.17, 0.0], [2.04, 0.94, 0.0]], 'ID': [[1.24, 1.18, 0.0], [0.0, 0.0, 0.0], [1.18, 1.03, 0.0], [1.16, 1.01, 1.0], [1.18, 1.0, 2.0], [1.2, 1.02, 0.0], [1.21, 1.03, 0.0], [1.24, 1.05, 0.0], [1.17, 1.01, 0.0], [1.19, 1.04, 0.0], [1.21, 1.03, 0.0], [1.21, 1.04, 0.0], [1.25, 1.1, 0.0], [1.22, 1.07, 0.0], [1.22, 1.04, 0.0], [1.21, 1.03, 1.0], [1.19, 1.02, 0.0], [1.11, 1.03, 0.0], [1.1, 1.01, 0.0], [1.19, 1.08, 0.0], [1.16, 1.06, 0.0], [1.16, 1.16, 0.0]], 'CT': [[3.23, 0.83, 0.0], [0.0, 0.0, 0.0], [4.54, 0.83, 0.0], [5.7, 0.83, 0.0], [5.89, 0.86, 0.0], [5.71, 0.87, 0.0], [5.76, 0.92, 1.0], [5.89, 0.95, 0.0], [5.81, 0.96, 0.0], [5.49, 0.98, 0.0], [5.12, 1.0, 0.0], [4.57, 0.96, 0.0], [4.68, 0.99, 0.0], [4.22, 0.96, 0.0], [4.84, 0.95, 0.0], [4.16, 0.99, 0.0], [3.61, 0.93, 0.0], [4.26, 1.0, 0.0], [4.12, 1.0, 0.0], [3.99, 1.03, 0.0], [4.17, 1.03, 0.0], [3.65, 0.97, 0.0]], 'ME': [[1.32, 0.99, 0.0], [0.0, 0.0, 0.0], [1.42, 1.09, 0.0], [1.32, 1.0, 0.0], [1.32, 0.98, 0.0], [1.26, 0.97, 0.0], [1.24, 0.98, 0.0], [1.19, 0.96, 0.0], [1.19, 0.97, 0.0], [1.21, 0.99, 0.0], [1.17, 0.97, 0.0], [1.18, 0.95, 0.0], [1.2, 0.96, 0.0], [1.19, 0.94, 0.0], [1.24, 0.95, 0.0], [1.26, 0.96, 0.0], [1.18, 0.95, 0.0], [1.29, 0.99, 0.0], [1.3, 1.03, 0.0], [1.39, 1.05, 0.0], [1.53, 1.06, 0.0], [1.44, 1.02, 0.0]], 'MD': [[1.46, 0.63, 0.0], [0.0, 0.0, 0.0], [1.5, 0.71, 0.0], [1.51, 0.71, 0.0], [1.15, 0.69, 0.0], [1.63, 0.75, 0.0], [1.63, 0.78, 1.0], [1.66, 0.82, 0.0], [1.55, 0.8, 0.0], [1.68, 0.82, 0.0], [1.69, 0.79, 0.0], [1.71, 0.82, 0.0], [1.77, 0.79, 2.0], [1.71, 0.83, 0.0], [1.82, 0.83, 0.0], [1.81, 0.81, 0.0], [1.87, 0.84, 0.0], [2.09, 0.87, 0.0], [1.9, 0.86, 0.0], [1.85, 0.92, 0.0], [1.85, 0.89, 0.0], [1.73, 0.87, 0.0]], 'MA': [[3.07, 0.87, 0.0], [0.0, 0.0, 0.0], [3.13, 0.86, 0.0], [2.33, 0.83, 3.0], [2.34, 0.88, 0.0], [1.55, 0.92, 0.0], [2.77, 1.01, 0.0], [2.83, 1.03, 0.0], [2.73, 0.97, 0.0], [2.77, 0.98, 0.0], [2.63, 1.02, 0.0], [2.57, 1.02, 0.0], [2.46, 0.91, 0.0], [2.41, 1.05, 0.0], [2.46, 1.05, 0.0], [1.72, 0.97, 0.0], [1.5, 0.97, 0.0], [1.91, 1.08, 0.0], [2.05, 1.03, 0.0], [2.03, 1.06, 0.0], [2.3, 1.05, 0.0], [2.3, 1.05, 0.0]], 'OH': [[1.41, 0.75, 0.0], [0.0, 0.0, 0.0], [1.51, 0.74, 0.0], [1.63, 0.79, 0.0], [1.68, 0.81, 0.0], [1.69, 0.79, 0.0], [1.72, 0.81, 0.0], [1.84, 0.82, 1.0], [1.86, 0.84, 0.0], [2.0, 0.88, 0.0], [2.23, 0.94, 3.0], [2.46, 1.04, 0.0], [2.4, 1.05, 1.0], [2.11, 0.95, 0.0], [2.11, 0.98, 0.0], [2.04, 0.95, 0.0], [2.28, 1.0, 0.0], [2.38, 1.04, 0.0], [2.25, 1.03, 0.0], [2.14, 1.02, 0.0], [1.9, 1.01, 0.0], [1.94, 1.01, 0.0]], 'UT': [[1.08, 1.31, 0.0], [0.0, 0.0, 0.0], [1.12, 1.3, 0.0], [1.16, 1.26, 0.0], [1.46, 1.02, 0.0], [1.47, 0.98, 0.0], [1.59, 1.08, 0.0], [1.53, 1.04, 0.0], [1.51, 1.0, 0.0], [1.53, 1.02, 0.0], [1.58, 1.0, 0.0], [1.64, 1.04, 0.0], [1.66, 1.04, 0.0], [1.68, 1.02, 0.0], [1.81, 1.07, 0.0], [1.77, 1.06, 0.0], [1.66, 1.01, 0.0], [1.66, 0.99, 0.0], [1.06, 0.69, 0.0], [2.55, 0.89, 0.0], [1.03, 0.71, 0.0], [1.33, 1.45, 0.0]], 'MO': [[1.3, 0.81, 0.0], [0.0, 0.0, 0.0], [1.25, 0.81, 0.0], [1.24, 0.81, 3.0], [1.23, 0.83, 0.0], [1.33, 0.9, 0.0], [1.38, 0.93, 0.0], [1.31, 0.89, 0.0], [1.4, 0.9, 0.0], [1.42, 0.9, 0.0], [1.4, 0.89, 0.0], [1.51, 0.91, 0.0], [1.42, 0.9, 0.0], [1.46, 0.86, 0.0], [1.44, 0.83, 0.0], [1.41, 0.82, 2.0], [1.44, 0.82, 0.0], [1.55, 0.82, 0.0], [1.51, 0.81, 0.0], [1.54, 0.82, 0.0], [1.45, 0.85, 0.0], [1.41, 0.84, 0.0]], 'MN': [[1.38, 0.98, 0.0], [0.0, 0.0, 0.0], [1.41, 0.98, 0.0], [1.43, 0.95, 0.0], [1.29, 0.96, 0.0], [1.38, 0.97, 0.0], [1.19, 0.97, 0.0], [1.28, 0.96, 0.0], [1.35, 0.98, 0.0], [1.25, 0.98, 0.0], [1.23, 1.02, 0.0], [1.23, 0.98, 0.0], [1.23, 0.96, 0.0], [1.07, 0.98, 0.0], [1.09, 0.97, 0.0], [1.09, 0.97, 0.0], [1.05, 0.97, 0.0], [1.1, 0.95, 0.0], [1.1, 0.95, 0.0], [1.11, 0.95, 0.0], [1.11, 0.94, 0.0], [1.12, 0.91, 0.0]], 'MI': [[3.42, 0.76, 0.0], [0.0, 0.0, 0.0], [4.88, 0.77, 0.0], [2.32, 0.79, 0.0], [2.47, 0.8, 0.0], [0.87, 0.84, 0.0], [0.89, 0.85, 0.0], [0.89, 0.85, 0.0], [0.88, 0.85, 0.0], [0.92, 0.88, 0.0], [0.93, 0.9, 0.0], [0.96, 0.91, 0.0], [0.97, 0.9, 0.0], [0.94, 0.91, 0.0], [0.94, 0.91, 0.0], [0.93, 0.91, 0.0], [0.92, 0.89, 0.0], [0.91, 0.88, 0.0], [0.89, 0.88, 0.0], [0.88, 0.91, 0.0], [0.87, 0.92, 0.0], [0.84, 0.96, 0.0]], 'RI': [[1.61, 0.84, 0.0], [0.0, 0.0, 0.0], [1.55, 0.78, 0.0], [1.82, 0.8, 0.0], [1.73, 0.81, 0.0], [2.1, 0.87, 0.0], [2.24, 0.89, 0.0], [2.26, 0.89, 0.0], [2.34, 0.9, 0.0], [2.24, 0.93, 0.0], [2.33, 0.87, 0.0], [2.42, 0.88, 0.0], [2.68, 0.94, 0.0], [2.99, 0.97, 0.0], [2.95, 0.97, 0.0], [3.04, 0.94, 0.0], [3.11, 0.95, 0.0], [3.01, 0.92, 0.0], [3.0, 0.91, 0.0], [3.23, 0.88, 0.0], [3.18, 0.94, 0.0], [3.63, 0.9, 0.0]], 'KS': [[1.2, 1.16, 0.0], [0.0, 0.0, 0.0], [1.18, 1.13, 2.0], [1.18, 1.12, 0.0], [1.26, 1.15, 0.0], [1.26, 1.13, 0.0], [1.25, 1.12, 0.0], [1.25, 1.2, 0.0], [1.29, 1.12, 0.0], [1.28, 1.12, 0.0], [1.3, 1.13, 0.0], [1.28, 1.13, 0.0], [1.24, 1.14, 0.0], [1.22, 1.13, 0.0], [1.26, 1.08, 0.0], [1.31, 1.11, 3.0], [1.22, 1.09, 0.0], [1.21, 1.08, 0.0], [1.2, 1.12, 0.0], [1.21, 1.13, 0.0], [1.26, 1.14, 0.0], [1.25, 1.22, 0.0]], 'MT': [[0.98, 1.07, 0.0], [0.0, 0.0, 0.0], [1.06, 1.0, 0.0], [1.06, 1.05, 2.0], [1.12, 1.08, 0.0], [1.11, 1.02, 0.0], [1.11, 1.12, 0.0], [1.18, 1.14, 0.0], [1.14, 1.15, 0.0], [1.09, 1.05, 0.0], [1.09, 1.06, 0.0], [1.07, 1.13, 0.0], [1.06, 1.13, 0.0], [1.04, 1.11, 0.0], [1.04, 1.1, 0.0], [1.08, 1.11, 1.0], [1.11, 1.16, 0.0], [1.1, 1.1, 2.0], [1.15, 1.11, 0.0], [1.2, 1.15, 0.0], [1.1, 1.16, 0.0], [1.07, 1.15, 0.0]], 'MS': [[1.01, 0.97, 0.0], [0.0, 0.0, 0.0], [1.05, 1.01, 0.0], [1.12, 1.01, 0.0], [1.1, 1.04, 0.0], [1.09, 1.0, 0.0], [1.08, 0.98, 0.0], [1.07, 1.0, 0.0], [1.09, 1.04, 0.0], [1.13, 1.04, 0.0], [1.13, 1.04, 0.0], [1.12, 1.05, 0.0], [1.08, 1.04, 0.0], [1.14, 1.06, 0.0], [1.16, 1.08, 0.0], [1.16, 1.08, 0.0], [1.11, 0.95, 0.0], [1.12, 0.97, 0.0], [1.09, 1.01, 0.0], [1.13, 1.0, 0.0], [1.12, 1.01, 0.0], [1.15, 1.08, 0.0]], 'SC': [[1.33, 0.87, 0.0], [0.0, 0.0, 0.0], [1.34, 0.93, 0.0], [1.34, 0.91, 0.0], [1.3, 0.89, 0.0], [1.33, 0.91, 0.0], [1.22, 0.93, 0.0], [1.21, 0.92, 0.0], [1.22, 0.93, 0.0], [1.22, 0.94, 0.0], [1.21, 0.92, 0.0], [1.17, 0.94, 0.0], [1.26, 1.0, 0.0], [1.3, 1.01, 0.0], [1.33, 1.03, 0.0], [1.31, 0.99, 0.0], [1.31, 1.01, 0.0], [1.36, 1.0, 0.0], [1.15, 1.0, 0.0], [1.14, 1.0, 0.0], [1.1, 0.98, 0.0], [1.06, 0.96, 0.0]], 'KY': [[1.12, 0.91, 3.0], [0.0, 0.0, 0.0], [1.37, 1.04, 0.0], [1.32, 1.04, 0.0], [1.33, 1.02, 0.0], [1.36, 1.11, 0.0], [1.39, 1.08, 0.0], [1.44, 1.1, 0.0], [1.44, 1.07, 0.0], [1.42, 1.06, 0.0], [1.44, 1.07, 0.0], [1.48, 1.08, 0.0], [1.42, 1.04, 0.0], [1.48, 1.07, 0.0], [1.48, 1.05, 0.0], [1.46, 1.04, 0.0], [1.47, 1.03, 0.0], [1.45, 1.05, 0.0], [1.46, 1.06, 0.0], [1.49, 1.08, 0.0], [1.46, 1.06, 0.0], [1.42, 1.07, 0.0]], 'OR': [[0.98, 0.98, 0.0], [0.0, 0.0, 0.0], [1.01, 0.99, 0.0], [1.07, 1.01, 0.0], [1.09, 1.03, 0.0], [1.09, 1.02, 0.0], [1.09, 1.06, 0.0], [1.16, 1.08, 0.0], [1.2, 1.04, 0.0], [1.2, 1.05, 0.0], [1.17, 1.07, 0.0], [1.24, 1.07, 0.0], [1.27, 1.05, 0.0], [1.3, 1.08, 0.0], [1.24, 1.05, 0.0], [1.28, 1.06, 0.0], [1.3, 1.07, 0.0], [1.27, 1.08, 0.0], [1.21, 1.04, 0.0], [1.26, 1.08, 0.0], [1.27, 1.07, 0.0], [1.2, 1.08, 0.0]], 'SD': [[1.31, 1.08, 0.0], [0.0, 0.0, 0.0], [1.3, 1.01, 0.0], [1.19, 0.98, 0.0], [1.36, 0.98, 0.0], [1.36, 0.81, 0.0], [1.21, 1.01, 0.0], [1.34, 1.05, 0.0], [1.42, 1.1, 0.0], [1.3, 1.12, 0.0], [1.32, 1.15, 0.0], [1.3, 1.14, 0.0], [1.3, 1.17, 0.0], [1.29, 1.22, 0.0], [1.3, 1.19, 0.0], [1.27, 1.18, 0.0], [1.28, 1.19, 0.0], [1.19, 1.13, 0.0], [1.19, 1.15, 0.0], [1.17, 1.19, 0.0], [1.11, 1.19, 0.0], [1.11, 1.21, 0.0]]}
var statesabb = ["AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DE", "FL", "GA", "ID", "IL", "IN", "IA", "KS", "KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN", "TX", "UT", "VT", "VA", "WA", "WV", "WI", "WY"]
var statedict = {'AK': 'Alaska','AL': 'Alabama','AR': 'Arkansas','AZ': 'Arizona','CA': 'California','CO': 'Colorado','CT': 'Connecticut','DE': 'Delaware','FL': 'Florida','GA': 'Georgia','IA': 'Iowa','ID': 'Idaho','IL': 'Illinois','IN': 'Indiana','KS': 'Kansas','KY': 'Kentucky','LA': 'Louisiana','MA': 'Massachusetts','MD': 'Maryland','ME': 'Maine','MI': 'Michigan','MN': 'Minnesota','MO': 'Missouri','MS': 'Mississippi','MT': 'Montana','NC': 'North Carolina','ND': 'North Dakota','NE': 'Nebraska','NH': 'New Hampshire','NJ': 'New Jersey','NM': 'New Mexico','NV': 'Nevada','NY': 'New York','OH': 'Ohio','OK': 'Oklahoma','OR': 'Oregon','PA': 'Pennsylvania','RI': 'Rhode Island','SC': 'South Carolina','SD': 'South Dakota','TN': 'Tennessee','TX': 'Texas','UT': 'Utah','VA': 'Virginia','VI': 'Virgin Islands','VT': 'Vermont','WA': 'Washington','WI': 'Wisconsin','WV': 'West Virginia','WY': 'Wyoming'}
var y_bounds=[36,sgheight-25]
var locked_state=0

sg.click(svg_unlock)

// set the min and max ratio
var max_ratio_state=0
var min_ratio_state=100
var max_ratio_total=0
var min_ratio_total=100

for(var state in data){
	temp=data[state].map(function(list){return list[0]})
	max=Math.max(...temp)
	for(var i=0;i<temp.length;i++){
		if(temp[i]!=0){
			if (temp[i]<min_ratio_state){
				min_ratio_state=temp[i]
			}
		}
	}

	if(max>max_ratio_state){max_ratio_state=max}
}

for(var state in data){
	temp=data[state].map(function(list){return list[1]})
	max=Math.max(...temp)
	for(var i=0;i<temp.length;i++){
		if(temp[i]!=0){
			if (temp[i]<min_ratio_total){
				min_ratio_total=temp[i]
			}
		}
	}

	if(max>max_ratio_total){max_ratio_total=max}
}

// max_ratio_total=max_ratio_state
// min_ratio_state=min_ratio_total

datat=data

drawkey()
drawgraph(1,1)

function yvalue(y,type){
	if(type==1){
		return Math.round(y_bounds[0]+y_bounds[1]-(y_bounds[0]+(y_bounds[1]-y_bounds[0])*((y-min_ratio_state)/(max_ratio_state-min_ratio_state))))
	}
	if(type==0){
		// return Math.round(y_bounds[0]+y_bounds[1]-(y_bounds[0]+(y_bounds[1]-y_bounds[0])*((y-min_ratio_state)/(max_ratio_state-min_ratio_state))))
		return Math.round(y_bounds[0]+y_bounds[1]-(y_bounds[0]+(y_bounds[1]-y_bounds[0])*((y-min_ratio_total)/(max_ratio_total-min_ratio_total))))
	}
}

function drawkey(){
	var key1=sg.circle(maxwidth+20,69,5).attr({fill:'#67c2a5',keep:1,'stroke-width':1,stroke:'black'})
	var keytext1=sg.text(maxwidth+30,69,'School funding reform event').attr({state:'none','font-family':'Lato','text-anchor':'start','font-size':size*1.2,'dominant-baseline':'middle',delete:1,keep:1})
	var keytext2=sg.text(maxwidth+15,55,['Click',' to lock in a state ',' / ']).attr({state:'none','font-family':'Lato','text-anchor':'start','font-size':size*1.2,delete:1,keep:1})
	keytext2.selectAll("tspan")[0].attr({'font-weight':'bold'})
	var keytext3=sg.text(maxwidth+180,55,['Click',' again to unlock']).attr({state:'none','font-family':'Lato','text-anchor':'start','font-size':size*1.2,delete:1,keep:1})
	keytext3.selectAll("tspan")[0].attr({'font-weight':'bold'})
	// var coords=keytext1.getBBox()
	// var key2=sg.circle(coords.x2+22,55,5).attr({fill:'#fc8d62',keep:1,'stroke-width':1,stroke:'black'})
	// var keytext2=sg.text(coords.x2+32,55,'Legislative reform').attr({state:'none','font-family':'Lato','text-anchor':'start','font-size':size*1.3,'dominant-baseline':'middle',delete:1,keep:1})
	// var coords=keytext2.getBBox().x2
	// var side=(sgwidth-coords)/2
}

function drawgraph(type,first){
	var x_bounds=[maxwidth,sgwidth-maxwidth]

	// set button class
	if(type==1){
		document.getElementById("statebutton").className = "sgbuttonleft pressed";
		document.getElementById("statebutton").disabled = true
		document.getElementById("totalbutton").className = "sgbuttonright";
		document.getElementById("totalbutton").disabled = false
	}
	if(type!=1){
		document.getElementById("statebutton").className = "sgbuttonleft";
		document.getElementById("statebutton").disabled = false
		document.getElementById("totalbutton").className = "sgbuttonright pressed";
		document.getElementById("totalbutton").disabled = true
	}

	if(first==1){
		// draw title
		sg.text(maxwidth+15,14,'For every $1 spent on high-income districts,').attr({'font-family':'Lato','font-size':size*1.6,'text-anchor':'start',state:'none','font-weight':'bold'})
		sg.text(maxwidth+15,34,'low-income districts received...').attr({'font-family':'Lato','font-size':size*1.6,'text-anchor':'start',state:'none','font-weight':'bold'})

		// draw year stops
		sg.text(maxwidth,y_bounds[1],'1990').attr({'font-family':'Lato','font-size':size*1.6,'text-anchor':'middle','dominant-baseline':'text-before-edge',state:'none'})
		sg.text(sgwidth-maxwidth,y_bounds[1],'2011').attr({'font-family':'Lato','font-size':size*1.6,'text-anchor':'middle','dominant-baseline':'text-before-edge',state:'none'})
	}

	// put down text and draw lines
	for(var state in datat){
		var obs=datat[state]

		if(type==1){
			var value2=obs[obs.length-1][0]
			if(obs[0][0]!=0){
				var value=obs[0][0]
			} else{
				var value=obs[2][0]
			}
		} else{
			var value2=obs[obs.length-1][1]
			if(obs[0][1]!=0){
				var value=obs[0][1]
			} else{
				var value=obs[2][1]
			}
		}

		yplace=yvalue(value,type)
		yplace2=yvalue(value2,type)
	
		var prev_value=null
		var path=''
		for(var j=0;j<obs.length;j++){
			var obs2=obs[j]
			if(type==1){
				value=obs2[0]
				if(value!=0){
					var ycoord=yvalue(value,type)
					if(prev_value!=null){
						path=path+'L '+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+ycoord+' '
					} else{
						path=path+'M '+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+ycoord+' '
					}
					prev_value=ycoord
				} else{}
			} else{
				value=obs2[1]
				if(value!=0){
					var ycoord=yvalue(value,type)
					if(prev_value!=null){
						path=path+'L '+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+ycoord+' '
					} else{
						path=path+'M '+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+ycoord+' '
					}
					prev_value=ycoord
				} else{}
			}

			if(obs2[2]!=0){
				if(state==1){
					if(obs2[0]==0 & j!=0){
						var obs3=data[(i*22)+(j-1)]
						var obs2=data[(i*22)+(j+1)]
						var temp=((obs3[2]/obs3[3])+(obs2[2]/obs2[3]))/2
						var ycoord=y_bounds[0]+y_bounds[1]-(y_bounds[0]+(y_bounds[1]-y_bounds[0])*((temp-min_ratio)/(max_ratio-min_ratio)))
					}
				}
				if(state!=1){
					if(obs[4]==null | obs[5]==null & j!=0){
						var obs3=data[(i*22)+(j-1)]
						var obs2=data[(i*22)+(j+1)]
						var temp=((obs3[4]/obs3[5])+(obs2[4]/obs2[5]))/2
						var ycoord=y_bounds[0]+y_bounds[1]-(y_bounds[0]+(y_bounds[1]-y_bounds[0])*((temp-min_ratio)/(max_ratio-min_ratio)))
					}
				}

				if(type==1){
					if(obs2[0]==0 & j!=0){
						var obs3=obs[j-1]
						var obs2=obs[j+1]
						var temp=(obs3[0]+obs2[0])/2
						var ycoord=yvalue(temp,type)
					}
				} else {
					if(obs2[1]==0 & j!=0){
						var obs3=obs[j-1]
						var obs2=obs[j+1]
						var temp=(obs3[1]+obs2[1])/2
						var ycoord=yvalue(temp,type)
					}
				}

				if(first==1){
					if(obs2[2]>0){
						var circ=sg.circle(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j),ycoord,5).attr({fill:'#67c2a5',type:'statepath',state:state,opacity:.1,'stroke-width':1,stroke:'black',j:j})
					} 
					// else if (obs2[2]==1){
					// 	var circ=sg.circle(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j),ycoord,5).attr({fill:'#67c2a5',type:'statepath',state:state,opacity:.1,'stroke-width':1,stroke:'black',j:j})
					// 	circ.hover(show_state,hide_state)
					// } else {
					// 	var circ1=sg.path('M'+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+(ycoord+4.5)+'A4.5,4.5 0 1 1 '+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+(ycoord-4.5)).attr({fill:'#fc8d62',type:'statepath',state:state,opacity:.1,'halfcirc':1,j:j,'leftcirc':1})
					// 	var circ2=sg.path('M'+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+(ycoord+4.5)+'A4.5,4.5 0 1 0 '+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+(ycoord-4.5)).attr({fill:'#67c2a5',type:'statepath',state:state,opacity:.1,'halfcirc':1,j:j,'leftcirc':0})
					// 	var outline=sg.circle(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j),ycoord,5).attr({fill:'none',stroke:'black','stroke-width':1,opacity:.1,state:state,j:j,type:'statepath'})
					// 	circ1.hover(show_state,hide_state)
					// 	circ2.hover(show_state,hide_state)
					// }
				} else{
					if(obs2[2]>0){
						sg.select("circle[type='statepath'][state='"+state+"'][j='"+j+"']").animate({cy:ycoord},1000)
					} 
					// else if (obs2[2]==1){
					// 	sg.select("circle[type='statepath'][state='"+state+"'][j='"+j+"']").animate({cy:ycoord},1000)
					// } else {
					// 	sg.selectAll("path[type='statepath'][state='"+state+"'][j='"+j+"'][leftcirc='1']").animate({path:'M'+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+(ycoord+5)+'A5,5 0 1 1 '+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+(ycoord-5)},1000)
					// 	sg.selectAll("path[type='statepath'][state='"+state+"'][j='"+j+"'][leftcirc='0']").animate({path:'M'+(-1+x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+(ycoord+5)+'A5,5 0 1 0 '+(x_bounds[0]+((x_bounds[1]-x_bounds[0])/21)*(j))+' '+(ycoord-5)},1000)
					// 	sg.select("circle[type='statepath'][state='"+state+"'][j='"+j+"']").animate({cy:ycoord},1000)
					// }
				}
			}
		}

		if(first==1){
			if(obs[0][0]!=0){
				var statepath=sg.path(path).attr({'stroke':'black','stroke-width':3,fill:'none',state:state,'stroke-opacity':.1,type:'statepath',type2:'nrlythepath',startval:obs[0][0].toFixed(2),endval:obs[obs.length-1][0].toFixed(2)})
				var statepathback=sg.path(path).attr({'stroke':'black','stroke-width':16,fill:'none',state:state,'stroke-opacity':0,type:'statepath',type2:'fakepath',startval:obs[0][0].toFixed(2),endval:obs[obs.length-1][0].toFixed(2)})
			} else{
				var statepath=sg.path(path).attr({'stroke':'black','stroke-width':3,fill:'none',state:state,'stroke-opacity':.1,type:'statepath',type2:'nrlythepath',startval:obs[2][0].toFixed(2),endval:obs[obs.length-1][0].toFixed(2)})
				var statepathback=sg.path(path).attr({'stroke':'black','stroke-width':16,fill:'none',state:state,'stroke-opacity':0,type:'statepath',type2:'fakepath',startval:obs[0][0].toFixed(2),endval:obs[obs.length-1][0].toFixed(2)})
			}
			statepathback.hover(show_state,hide_state)
			// statepath.click(lock_state)
		} else{
			sg.selectAll("path[type='statepath'][state='"+state+"'][type2='nrlythepath']").animate({'path':path},1000)
			sg.selectAll("path[type='statepath'][state='"+state+"'][type2='fakepath']").attr({'path':path})
			// sg.select("path[type='statepath'][state='"+state+"']").animate({'path':path},1000)
			if(type==1){
				if(obs[0][0]!=0){
					sg.select("path[type='statepath'][state='"+state+"']").attr({endval:obs[obs.length-1][0].toFixed(2),startval:obs[0][0].toFixed(2)})
				} else{
					sg.select("path[type='statepath'][state='"+state+"']").attr({endval:obs[obs.length-1][0].toFixed(2),startval:obs[2][0].toFixed(2)})
				}
			} else{
				if(obs[0][0]!=0){
					sg.select("path[type='statepath'][state='"+state+"']").attr({endval:obs[obs.length-1][1].toFixed(2),startval:obs[0][1].toFixed(2)})
				} else{
					sg.select("path[type='statepath'][state='"+state+"']").attr({endval:obs[obs.length-1][1].toFixed(2),startval:obs[2][1].toFixed(2)})
				}
			}
		}
	}

	// draw the ratio=1 line
	var yplace=yvalue(1,type)

	if(first==1){
		var fade = sg.gradient("r(0.5, 0.5, 0.8)rgba(255,255,255,1.0)-rgba(255,255,255,0.0)");
		var fadebox=sg.ellipse(sgwidth/2,yplace,130,40).attr({fill:fade,fadebox:1,type:'front'})
		var ratio1=sg.line(x_bounds[0],yplace,x_bounds[1],yplace).attr({'stroke-width':2,stroke:'#C63F26','shape-rendering':'crispEdges',oneline:1,type:'front'})
		var ratio1text1=sg.text(sgwidth/2,yplace,'Regressive school funding').attr({state:'none','font-family':'Lato','text-anchor':'middle',fill:'black','font-size':size*1.2,'dominant-baseline':'text-before-edge','font-weight':400,type:'front',oneline:0,fill:'#C63F26'})
		var tcoords=(sgwidth/2)-(ratio1text1.getBBox().width/2)
		var ratio1text2=sg.text(tcoords-1,yplace-5,'Progressive school funding').attr({state:'none','font-family':'Lato','text-anchor':'start',fill:'black','font-size':size*1.2,'font-weight':400,type:'front',oneline:0,fill:'#C63F26'})
		var arrow = sg.path('M0,0 L0,3 L3,1.5 L0,0').attr({fill: '#C63F26'})
		var amarker = arrow.marker(0,0,3,3,0,1.5).attr({});
		var upline=sg.line(tcoords-6,yplace-5,tcoords-6,yplace-10).attr({ident:'none',class:'callout','stroke-width':2,'stroke':'black','shape-rendering':'auto','marker-end':amarker,oneline:0,stroke:'#C63F26',type:'front'})
		var downline=sg.line(tcoords-6,yplace+4,tcoords-6,yplace+9).attr({ident:'none',class:'callout','stroke-width':2,'stroke':'black','shape-rendering':'auto','marker-end':amarker,oneline:0,stroke:'#C63F26',type:'front'})
		var leftline=sg.line(maxwidth,y_bounds[0],maxwidth,y_bounds[1]).attr({stroke:'black','stroke-width':1,'shape-rendering':'crispEdges'})
		var rightline=sg.line(sgwidth-maxwidth,y_bounds[0],sgwidth-maxwidth,y_bounds[1]).attr({stroke:'black','stroke-width':1,'shape-rendering':'crispEdges'})
		select('NJ')
	} else{
		var arrow = sg.path('M0,0 L0,3 L3,1.5 L0,0').attr({fill: '#C63F26'})
		var amarker = arrow.marker(0,0,3,3,0,1.5).attr({});

		a=sg.selectAll("text[oneline='0']")
		sg.select("[oneline='1']").animate({y1:yplace,y2:yplace},1000)
		y1=sg.select("[oneline='1']").attr('y1')
		diff=y1-yplace
		for(var b=0;b<a.length;b++){
			a[b].animate({y:parseFloat(a[b].attr('y'))-parseFloat(diff)},1000)
		}
		a=sg.selectAll("line[oneline='0']")
		for(var b=0;b<a.length;b++){
			a[b].animate({y1:parseFloat(a[b].attr('y1'))-parseFloat(diff),y2:parseFloat(a[b].attr('y2'))-parseFloat(diff)},1000)
			a[b].attr({'marker-end':amarker})
		}
		sg.select("[fadebox]").animate({cy:yplace},1000)
	}

	// animate the pricetags if necessary
	if(first!=1){
		if(type==1){
			var obs=data[selected_state]
			if(obs[0][0]!=0){
				var start1=obs[0][0].toFixed(2)
				var end1=obs[obs.length-1][0].toFixed(2)
				var start=yvalue(obs[0][0],1)
				var end=yvalue(obs[obs.length-1][0],1)
				var oldstart=yvalue(obs[0][1],0)
				var oldend=yvalue(obs[obs.length-1][1],0)
			} else{
				var start1=obs[2][0].toFixed(2)
				var end1=obs[obs.length-1][0].toFixed(2)
				var start=yvalue(obs[2][0],1)
				var end=yvalue(obs[obs.length-1][0],1)
				var oldstart=yvalue(obs[2][1],0)
				var oldend=yvalue(obs[obs.length-1][1],0)
			}
		} else {
			var obs=data[selected_state]
			if(obs[0][0]!=0){
				var start1=obs[0][1].toFixed(2)
				var end1=obs[obs.length-1][1].toFixed(2)
				var start=yvalue(obs[0][1],0)
				var end=yvalue(obs[obs.length-1][1],0)
				var oldstart=yvalue(obs[0][0],1)
				var oldend=yvalue(obs[obs.length-1][0],1)
			} else{
				var start1=obs[2][1].toFixed(2)
				var end1=obs[obs.length-1][1].toFixed(2)
				var start=yvalue(obs[2][1],0)
				var end=yvalue(obs[obs.length-1][1],0)
				var oldstart=yvalue(obs[2][0],1)
				var oldend=yvalue(obs[obs.length-1][0],1)
			}
		}

		var startdiff=(start-oldstart)
		var enddiff=(end-oldend)

		var c=sg.selectAll("[temptext='1'][lefttext]")
		var d=sg.selectAll("[temptext='1'][righttext]")

		tstringc=Snap.parseTransformString(c[0].attr('transform'))
		tstringd=Snap.parseTransformString(d[0].attr('transform'))

		if(tstringc.length!=0){
			startdiff=startdiff+tstringc[0][2]
			enddiff=enddiff+tstringd[0][2]
		}

		c.animate({transform:'t0 '+startdiff},1000)
		d.animate({transform:'t0 '+enddiff},1000)
		sg.select("text[lefttext][moneytext]").attr({text:'$'+start1})
		sg.select("text[righttext][moneytext]").attr({text:'$'+end1})
	}
}

// function lock_state(e){
// 	if(locked_state==0){
// 		item=Snap(e.target)
// 		locked_state=item.attr('state')
// 		sg.selectAll("path[state='"+state+"']").attr({'stroke-opacity':1})
// 	} else{
// 		locked_state=0
// 		sg.selectAll("path[state='"+state+"']").attr({'stroke-opacity':.5})
// 	}
// }

function svg_unlock(e){
	if(e.type=='path'){
		item=e
	} else{
		item=Snap(e.target)
	}
	if(locked_state==0 & (item.attr('type2')=='fakepath' | item.type=='circle')){
		console.log('check')
		locked_state=item.attr('state')
		sg.selectAll("path[state='"+locked_state+"'][type2='nrlythepath']").attr({'stroke-opacity':1})
		// sg.selectAll("path[state='"+state+"']").attr({'stroke-opacity':1})
	} else if(locked_state!=0 & (item.attr('type2')=='fakepath' | item.type=='circle')){
		console.log('check2')
		sg.selectAll("path[state='"+locked_state+"'][type2='nrlythepath']").attr({'stroke-opacity':.1})
		locked_state=0
		show_state(e)
		locked_state=item.attr('state')
		sg.selectAll("path[state='"+locked_state+"'][type2='nrlythepath']").attr({'stroke-opacity':1})
	} else if (locked_state!=0 & item.attr('type2')!='fakepath'){
		console.log('check3')
		sg.select("path[state='"+locked_state+"'][type2='nrlythepath']").attr({'stroke-opacity':.5})
		locked_state=0
	}
}

function show_state(e){
	if(locked_state==0){
		item=Snap(e.target)
		state=item.attr('state')
		select(state)
		document.getElementById("state_select").value=state
	}
}

function buttondown(type){
	if(type==1){
		if(document.getElementById("state_select").value)
		drawgraph(1,0)
	} else{
		drawgraph(0,0)
	}
}

function hide_state(e){}

function statechange(){
	state=document.getElementById("state_select").value
	select(state)
	locked_state=0
	a=sg.select("path[state='"+state+"'][type2='fakepath']")
	svg_unlock(a)
}

function select(state){
	selected_state=state
	sg.selectAll("[temptext]").remove()
	sg.selectAll("path[state][type2='nrlythepath']").attr({'stroke-opacity':.1})
	// sg.selectAll("path[halfcirc]").attr({'opacity':.2})
	sg.selectAll("circle[state]").attr({'opacity':.2})
	sg.selectAll("text:not([state='none'])").attr({opacity:0})
	sg.selectAll("[state='"+state+"'][type2='nrlythepath']").attr({opacity:1})
	sg.selectAll("circle[state='"+state+"']").attr({opacity:1})
	sg.selectAll("path[state='"+state+"'][type2='nrlythepath']").attr({'stroke-opacity':.5})

	var b=sg.select("path[state='"+state+"'][type='statepath'][type2='nrlythepath']")
	var a=Snap.parsePathString(b.attr('path'))
	var start=a[0][a[0].length-1]+1
	var end=a[a.length-1][a[a.length-1].length-1]+1

	var ltext=sg.text((maxwidth-6)/2,start-15,state).attr({'font-family':'Lato','font-size':size*1.8,'text-anchor':'middle',state:state,lefttext:0,bottom:0,temptext:1,lefttext:1})
	var lbox=sg.path('M'+(maxwidth-15)+' '+(start-12)+'L '+(maxwidth-6)+' '+(start-1.5)+'L '+(maxwidth-15)+' '+(start+9)).attr({stroke:'black',fill:'black',temptext:1,'stroke-linejoin':'bevel',lefttext:1})
	var lbox2=sg.rect(2,start-12,maxwidth-17,21).attr({fill:'none',stroke:'black','stroke-width':1,temptext:1,lefttext:1,'shape-rendering':'crispEdges'})
	var ltext2=sg.text(5,start+5,'$'+b.attr('startval')).attr({'font-family':'Lato','font-size':size*1.4,'text-anchor':'start',state:state,lefttext:0,bottom:0,temptext:1,fill:'black',lefttext:1,moneytext:1})

	var rtext=sg.text((sgwidth-maxwidth)+(maxwidth+6)/2,end-15,state).attr({'font-family':'Lato','font-size':size*1.8,'text-anchor':'middle',state:state,lefttext:0,bottom:0,temptext:1,righttext:1})
	var rbox=sg.path('M'+(sgwidth-maxwidth+15)+' '+(end-12)+'L '+(sgwidth-maxwidth+6)+' '+(end-1.5)+'L '+(sgwidth-maxwidth+15)+' '+(end+9)).attr({stroke:'black',fill:'black',temptext:1,'stroke-linejoin':'bevel',righttext:1})
	var rbox2=sg.rect(sgwidth-maxwidth+15,end-12,maxwidth-17,21).attr({fill:'none',stroke:'black','stroke-width':1,temptext:1,righttext:1,'shape-rendering':'crispEdges'})
	var rtext2=sg.text(sgwidth-maxwidth+18,end+5,'$'+b.attr('endval')).attr({'font-family':'Lato','font-size':size*1.4,'text-anchor':'start',state:state,lefttext:0,bottom:0,temptext:1,fill:'black',righttext:1,moneytext:1})

	sg.append(sg.selectAll("[fill='#67c2a5']"))
	sg.append(sg.selectAll("[fill='#fc8d62']"))
	sg.append(sg.selectAll("[type='front']"))
}

</script>
</html>